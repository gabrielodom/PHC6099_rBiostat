<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Gabriel Odom">
<meta name="dcterms.date" content="2023-07-18">
<title>An R Cookbook for Public Health - 16&nbsp; Correlation and Covariance Matrices</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lessons_original/04_regression_ols.html" rel="next">
<link href="../lessons_original/04_anova_random_intercept.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04_header_anova-and-regression.html">ANOVA and Regression</a></li><li class="breadcrumb-item"><a href="../lessons_original/04_correlation.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Correlation and Covariance Matrices</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">An R Cookbook for Public Health</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/gabrielodom/PHC6099_rBiostat" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Course Materials for PHC 6099: ‘R Computing for Health Sciences’</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">PHC 6099: R Computing for Health Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../01_header_EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/01_mosaic_violin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Mosaic &amp; Box/Violin Plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/01_scatterplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">How to Create a Scatterplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/01_skimr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Skimr Package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/01_table1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Demographics table with table1</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../02_header_one-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">One-Sample Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/02_z-test_one_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Z-Test for One Proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/02_fisher_exact_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Fisher’s Exact Test</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../03_header_two-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two-Sample Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/03_two_sample_ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Two sample <span class="math inline">\(t\)</span>-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/03_two_sample_mann_whitney.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mann-Whittney-U Test Example</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/03_two_sample_bootstrap_conf_int.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Bootstrap Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/03_two_sample_chi_sq_independence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Chi-Squared Independence</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../04_header_anova-and-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_anova_two_way.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Two-Way ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_anova_kruskal_wallis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Non-Parametric ANOVA: The Kruskal-Wallis Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_anova_random_intercept.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Random Intercept Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_correlation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Correlation and Covariance Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_regression_ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Ordinary Least Squares Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_regression_mls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/04_regression_polynomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Introduction to Polynomial Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">05_header_generalized_linear_models.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/05_glm_ordinal_logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Ordinal Logistic Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../06_header_special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Special Topics in Statistical Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/06_lesson_template_spec_topc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">The Method</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../07_header_power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Power and Sample Size Determination</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons_original/07_power_ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Power Analysis for OLS Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">16.1</span> Introduction</a></li>
  <li>
<a href="#about-covariance-and-correlation" id="toc-about-covariance-and-correlation" class="nav-link" data-scroll-target="#about-covariance-and-correlation"><span class="header-section-number">16.2</span> About Covariance and Correlation</a>
  <ul class="collapse">
<li><a href="#equations-properties-and-uses" id="toc-equations-properties-and-uses" class="nav-link" data-scroll-target="#equations-properties-and-uses"><span class="header-section-number">16.2.1</span> Equations, properties, and uses</a></li>
  </ul>
</li>
  <li><a href="#data-set-used" id="toc-data-set-used" class="nav-link" data-scroll-target="#data-set-used"><span class="header-section-number">16.3</span> Data set used</a></li>
  <li><a href="#covariance-matrix-procedure" id="toc-covariance-matrix-procedure" class="nav-link" data-scroll-target="#covariance-matrix-procedure"><span class="header-section-number">16.4</span> Covariance Matrix Procedure</a></li>
  <li>
<a href="#the-correlation-matrix-procedure" id="toc-the-correlation-matrix-procedure" class="nav-link" data-scroll-target="#the-correlation-matrix-procedure"><span class="header-section-number">16.5</span> The Correlation Matrix Procedure</a>
  <ul class="collapse">
<li><a href="#hypothesis-testing-in-correlations" id="toc-hypothesis-testing-in-correlations" class="nav-link" data-scroll-target="#hypothesis-testing-in-correlations"><span class="header-section-number">16.5.1</span> Hypothesis testing in correlations</a></li>
  <li><a href="#assumptions-of-a-correlation-matrix" id="toc-assumptions-of-a-correlation-matrix" class="nav-link" data-scroll-target="#assumptions-of-a-correlation-matrix"><span class="header-section-number">16.5.2</span> Assumptions of a Correlation Matrix:</a></li>
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions"><span class="header-section-number">16.5.3</span> Checking Assumptions</a></li>
  <li><a href="#computation-of-a-correlation-matrix" id="toc-computation-of-a-correlation-matrix" class="nav-link" data-scroll-target="#computation-of-a-correlation-matrix"><span class="header-section-number">16.5.4</span> Computation of a Correlation Matrix</a></li>
  </ul>
</li>
  <li>
<a href="#other-correlation-types-spearman-and-partial" id="toc-other-correlation-types-spearman-and-partial" class="nav-link" data-scroll-target="#other-correlation-types-spearman-and-partial"><span class="header-section-number">16.6</span> Other Correlation Types (Spearman and Partial)</a>
  <ul class="collapse">
<li><a href="#spearman-ranking-of-variables-non-parametric" id="toc-spearman-ranking-of-variables-non-parametric" class="nav-link" data-scroll-target="#spearman-ranking-of-variables-non-parametric"><span class="header-section-number">16.6.1</span> Spearman (ranking of variables, non-parametric)</a></li>
  <li><a href="#partial-correlation" id="toc-partial-correlation" class="nav-link" data-scroll-target="#partial-correlation"><span class="header-section-number">16.6.2</span> Partial Correlation</a></li>
  </ul>
</li>
  <li>
<a href="#example-of-r-in-examining-the-relationship-in-a-pair-of-variables-using-the-pearson-correlation-coefficient-type-of-correlation" id="toc-example-of-r-in-examining-the-relationship-in-a-pair-of-variables-using-the-pearson-correlation-coefficient-type-of-correlation" class="nav-link" data-scroll-target="#example-of-r-in-examining-the-relationship-in-a-pair-of-variables-using-the-pearson-correlation-coefficient-type-of-correlation"><span class="header-section-number">16.7</span> Example of <em>r</em> in examining the relationship in a pair of variables using the Pearson Correlation Coefficient type of correlation</a>
  <ul class="collapse">
<li><a href="#hypothesis-test-between-mpg-and-wt" id="toc-hypothesis-test-between-mpg-and-wt" class="nav-link" data-scroll-target="#hypothesis-test-between-mpg-and-wt"><span class="header-section-number">16.7.1</span> Hypothesis test between mpg and wt</a></li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">16.8</span> References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/gabrielodom/PHC6099_rBiostat/edit/main/lessons_original/04_correlation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gabrielodom/PHC6099_rBiostat/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04_header_anova-and-regression.html">ANOVA and Regression</a></li><li class="breadcrumb-item"><a href="../lessons_original/04_correlation.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Correlation and Covariance Matrices</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Correlation and Covariance Matrices</span>
</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lea Nehme &amp; Zhayda Reilly </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("skimr")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/skimr/">skimr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("ggpubr")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("patchwork")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("gtsummary")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary">gtsummary</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#StandWithUkraine</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://xtable.r-forge.r-project.org/">xtable</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("modelsummary")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://modelsummary.com">modelsummary</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`modelsummary` 2.0.0 now uses `tinytable` as its default table-drawing
  backend. Learn more at: https://vincentarelbundock.github.io/tinytable/

Revert to `kableExtra` for one session:

  options(modelsummary_factory_default = 'kableExtra')

Change the default backend persistently:

  config_modelsummary(factory_default = 'gt')

Silence this message forever:

  config_modelsummary(startup_message = FALSE)</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("rstatix")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/">rstatix</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("PerformanceAnalytics")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/braverock/PerformanceAnalytics">PerformanceAnalytics</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: xts</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
######################### Warning from 'xts' package ##########################
#                                                                             #
# The dplyr lag() function breaks how base R's lag() function is supposed to  #
# work, which breaks lag(my_xts). Calls to lag(my_xts) that you type or       #
# source() into this session won't work correctly.                            #
#                                                                             #
# Use stats::lag() to make sure you're not using dplyr::lag(), or you can add #
# conflictRules('dplyr', exclude = 'lag') to your .Rprofile to stop           #
# dplyr from breaking base R's lag() function.                                #
#                                                                             #
# Code in packages is not affected. It's protected by R's namespace mechanism #
# Set `options(xts.warn_dplyr_breaks_lag = FALSE)` to suppress this warning.  #
#                                                                             #
###############################################################################</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'xts'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    first, last</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("ppcor")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ppcor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:rstatix':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gtsummary':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:patchwork':

    area</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#install.packages("remotes")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org">remotes</a></span><span class="op">)</span></span>
<span><span class="co">#install.packages("conflicted")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://conflicted.r-lib.org/">conflicted</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">16.1</span> Introduction</h2>
<p>One of the general goals of statistics is to understand if there is a relationship between two variables.</p>
<ol type="1">
<li>
<p><strong>Covariance</strong> measures the degree to which the deviation of one variable (X) from its mean is related to the deviation of another variable (Y) from its mean. In other words, covariance measures the joint variability of two random variables or how these increase or decrease in relation with each other.</p>
<ol type="a">
<li><p>For instance, if greater values of one variable tend to correspond with greater values of another variable, this suggests positive covariance.</p></li>
<li><p>Covariance can have both positive and negative values.</p></li>
</ol>
</li>
<li><p>A <strong>Covariance Matrix</strong> shows the covariance between different variables of a data set.</p></li>
<li><p><strong>Correlation</strong> tells us both the strength and the direction of this relationship by listing the Correlation Coefficient (“Pearson”, “Spearman”, or “Kendall”) for the pair as measure of association.</p></li>
<li>
<p><strong>Correlation matrix</strong> allows for the exploration of the correlation among the multiple variables in a data set. It proves this information through a table listing the correlation coefficients (<strong>r</strong>) for each relationship between pair of variables in the data set.</p>
<ul>
<li>Correlation is best used for multiple variables that express a linear relationship with one another.</li>
<li>Correlation between two variables highlight how a change in one variable impacts a change in another variable.</li>
</ul>
</li>
</ol>
<blockquote class="blockquote">
<p>In sum, a covariance and a correlation matrix sound similar because covariance is a measure of correlation, while correlation is a scaled version of covariance. This means correlation is a special case of covariance which can be achieved when the data is in standardized form.</p>
</blockquote>
</section><section id="about-covariance-and-correlation" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="about-covariance-and-correlation">
<span class="header-section-number">16.2</span> About Covariance and Correlation</h2>
<section id="equations-properties-and-uses" class="level3" data-number="16.2.1"><h3 data-number="16.2.1" class="anchored" data-anchor-id="equations-properties-and-uses">
<span class="header-section-number">16.2.1</span> Equations, properties, and uses</h3>
<p><strong>Mathematical equations, properties, and uses</strong></p>
<p>Remember the equation for the variance for one variable</p>
<p><span class="math display">\[
var(x) = \frac{1}{n-1}{\sum_{i = 1}^{n}{(x_i - \bar{x})^2}}
\]</span></p>
<p><strong>Covariance: Relation between two variables</strong> where, (<em><strong>x_i</strong> are the values of the X-variable), (</em><strong>y_i</strong>* are the values of the Y-variable), (<strong><em>x_bar</em></strong> is the mean of the X-variable), (<strong>y_bar</strong>* is the mean of the Y-variable), and (<strong><em>n</em></strong> are the number of data points)</p>
<p><span class="math display">\[
Cov(x,y) = \frac{1}{n-1}{\sum_{i = 1}^{n}{(x_i - \bar{x})(y_i-\bar{y})}}
\]</span></p>
<section id="covariance-properties" class="level4" data-number="16.2.1.1"><h4 data-number="16.2.1.1" class="anchored" data-anchor-id="covariance-properties">
<span class="header-section-number">16.2.1.1</span> Covariance Properties</h4>
<ul>
<li>
<strong>(x, y) &gt; 0:</strong> the covariance for both variables is positive or moving in the same direction.</li>
<li>
<strong>(x, y) &lt; 0:</strong> the covariance for both variables is negative or moving in the opposite direction.</li>
<li>
<strong>(x, y) = 0:</strong> there is no relationship between the variables.</li>
</ul>
<p><strong>Covariance Matrix: Covariance between variables in a data set</strong></p>
<p><span class="math display">\[
C = \frac{1}{n-1}{\sum_{i = 1}^{n}{(X_i - \bar{X})(X_i-\bar{X})}^T}
\]</span></p>
<p><strong>The general formula to represent a covariance matrix</strong></p>
<p><span class="math display">\[
\begin{bmatrix} Var(x_{1}) &amp; ... &amp; Cov(x_{1},x_{n})\\ : &amp;. &amp; :\\ :&amp; \: \: \: \: \: \: \: \: \: \: .&amp; :\\ Cov(x_{n},x_{1}) &amp; ... &amp; Var(x_{n}) \end{bmatrix}.
\]</span></p>
<p><strong>Uses of a covariance matrix</strong></p>
<ul>
<li>Calculate the Mahalanobis distance.,</li>
<li>Kalman filters.,</li>
<li>Gaussian mixture models.</li>
<li>PCA (principal component analysis)</li>
</ul>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This is of importance and allows us to see the relationship between covariance and correlation in this simplified equation for the Pearson Correlation Coefficient, <em>r</em>. [video explaining standarization and mathematical properties of r]: </p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/2bcmklvrXTQ" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<span class="citation" data-cites="tilestats2021"><sup><a href="#ref-tilestats2021" role="doc-biblioref"><strong>tilestats2021?</strong></a></sup></span>
</div>
</div>
</div>
<p><span class="math display">\[
r = \frac {Cov(x,y)}{(\sqrt{var(x)})(\sqrt{var(y)})}
\]</span></p>
</section><section id="correlation-matrix" class="level4" data-number="16.2.1.2"><h4 data-number="16.2.1.2" class="anchored" data-anchor-id="correlation-matrix">
<span class="header-section-number">16.2.1.2</span> Correlation Matrix</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_correlation_matrix_example.png" class="img-fluid figure-img"></p>
<figcaption>Sample correlation matrix</figcaption></figure>
</div>
<p><strong>Correlation Properties: direction</strong></p>
<ul>
<li>
<strong>r = 1:</strong> A perfect positive correlation.</li>
<li>
<strong>r = 0:</strong> Zero or no correlation.</li>
<li>
<strong>r = -1:</strong> A perfect negative relationship. where,
<ul>
<li>The sign of the correlation coefficient indicates the direction of the association.</li>
</ul>
</li>
</ul>
<p><strong>Correlation Properties: strength</strong></p>
<ul>
<li>.1 &lt; | <em>r</em> | &lt; .3 (small / weak correlation).</li>
<li>.3 &lt; | <em>r</em> | &lt; .5 (medium / moderate correlation).</li>
<li>.5 &lt; | <em>r</em> | (large / strong correlation).
<ul>
<li>The magnitude of the correlation coefficient indicates the strength of the association.</li>
</ul>
</li>
</ul>
<p><strong>Correlation uses</strong></p>
<ul>
<li>To summarize the correlation among various variables of a data set.</li>
<li>To perform regression testing (like multicollinarity)</li>
<li>Basis of other analyses (like regression models)</li>
</ul>
<p><strong>Correlation, r and Covariance</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_correlation_cor_vs_cov.png" class="img-fluid figure-img"></p>
<figcaption>Visual contrast</figcaption></figure>
</div>
<p>We will concentrate on the <strong>Correlation Matrix</strong> which provides the Pearson Correlation Coefficient or (its variations for non-parametric data such as, spearman and kendall).</p>
</section></section></section><section id="data-set-used" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="data-set-used">
<span class="header-section-number">16.3</span> Data set used</h2>
<p>We will use the R data set “mtcars” to provide examples on developing a <strong>Covariance Matrix</strong> and on checking the assumptions for and development of a <strong>Correlation Matrix</strong> using the pearson correlation coefficient.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span><span class="co"># Print sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>    format <span class="op">=</span> <span class="st">"markdown"</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"The mtcars data set"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>The mtcars data set</caption>
<colgroup>
<col style="width: 26%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.88</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.46</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="covariance-matrix-procedure" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="covariance-matrix-procedure">
<span class="header-section-number">16.4</span> Covariance Matrix Procedure</h2>
<p>The procedure to develop a covariance matrix uses the cov() function. It takes the data frame as an argument and returns the covariance matrix as result. It is as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html">conflicts_prefer</a></span><span class="op">(</span><span class="fu">rstatix</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[conflicted] Will prefer rstatix::select over any other package.</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars2</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">mtcars2_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">mtcars2_cov</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Covariance of mtcars using the Pearson type"</span></span>
<span>      <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Covariance of mtcars using the Pearson type</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">36.324103</td>
<td style="text-align: right;">-633.09721</td>
<td style="text-align: right;">-320.73206</td>
<td style="text-align: right;">2.1950635</td>
<td style="text-align: right;">-5.1166847</td>
<td style="text-align: right;">4.5091492</td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">-633.097208</td>
<td style="text-align: right;">15360.79983</td>
<td style="text-align: right;">6721.15867</td>
<td style="text-align: right;">-47.0640192</td>
<td style="text-align: right;">107.6842040</td>
<td style="text-align: right;">-96.0516815</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">-320.732056</td>
<td style="text-align: right;">6721.15867</td>
<td style="text-align: right;">4700.86694</td>
<td style="text-align: right;">-16.4511089</td>
<td style="text-align: right;">44.1926613</td>
<td style="text-align: right;">-86.7700806</td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">2.195063</td>
<td style="text-align: right;">-47.06402</td>
<td style="text-align: right;">-16.45111</td>
<td style="text-align: right;">0.2858814</td>
<td style="text-align: right;">-0.3727207</td>
<td style="text-align: right;">0.0871407</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">-5.116685</td>
<td style="text-align: right;">107.68420</td>
<td style="text-align: right;">44.19266</td>
<td style="text-align: right;">-0.3727207</td>
<td style="text-align: right;">0.9573790</td>
<td style="text-align: right;">-0.3054816</td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">4.509149</td>
<td style="text-align: right;">-96.05168</td>
<td style="text-align: right;">-86.77008</td>
<td style="text-align: right;">0.0871407</td>
<td style="text-align: right;">-0.3054816</td>
<td style="text-align: right;">3.1931661</td>
</tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<ol type="1">
<li>Only the “continuous” variables of mtcars were included in this covariance matrix because the default type of procedure is “Pearson”.</li>
<li>The printout of the covariance matrix is not easy to read or as useful as the correlation matrix which has several functions that allow for visual and organizational displays of information.</li>
<li>Some of the results are the following:<br>
</li>
</ol>
<ul>
<li>The values along the diagonals of the matrix are simply the variances of each product.</li>
<li>The variance of mpg is 36.32</li>
<li>The variance of disp is 15360.8</li>
<li>The other values in the matrix represent the covariances between the various products, for example:</li>
<li>The covariance between mpg and disp is -633.10, this is a negative covariance indicating that vehicles that are fuel efficient or have high miles per galon have lower levels of displacement (smaller engines, less powerful).</li>
<li>The covariance between hp and wt is 44.19, this is a positive covariance indicating that as horse power increases, so does the weight of a vehicle.</li>
</ul>
</blockquote>
</section><section id="the-correlation-matrix-procedure" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="the-correlation-matrix-procedure">
<span class="header-section-number">16.5</span> The Correlation Matrix Procedure</h2>
<p>The <strong>Correlation Matrix</strong> procedure is of emphasis because it provides information on the linear relationship among variables (strength and direction). This analysis is of importance to build Regression and multivariate models, as it assists in:</p>
<div class="border">
<pre><code>1. The observation of patterns and associations in the data.
2. To conduct or as the basis of other analyses (linear regression models)
3. To conduct diagnostic checks (multicollinearity)</code></pre>
</div>
<section id="hypothesis-testing-in-correlations" class="level3" data-number="16.5.1"><h3 data-number="16.5.1" class="anchored" data-anchor-id="hypothesis-testing-in-correlations">
<span class="header-section-number">16.5.1</span> Hypothesis testing in correlations</h3>
<p>The bivariate Pearson Correlation produces a sample correlation coefficient, <em>r</em>, which measures the strength and direction of linear relationships between pairs of continuous variables in a sample. By extension, the Pearson Correlation evaluates whether there is statistical evidence for a linear relationship among the same pairs of variables in the population, represented by a population correlation coefficient, ρ (“rho”), which is unknown. The sample pearson correlation coefficient, <em>r</em>, is the estimate of the unknown population coefficient (ρ). Therefore,</p>
<blockquote class="blockquote">
<p>The hypothesis test lets us decide whether the value of the population correlation coefficient ρ is “close to zero” or “significantly different from zero”. We decide this based on the sample correlation coefficient r and the sample size n .</p>
</blockquote>
<p><strong>Two-tailed significance test:</strong></p>
<p>The <strong>null hypothesis</strong> for a two-tailed significance test of a correlation is: <span class="math display">\[
H_0: ρ = 0
\]</span> rho is zero or approximately zero. This means that the relationship in the population is equal to 0; (“there is no association”)</p>
<p>The <strong>alternative hypothesis</strong> for a two-tailed significance test of a correlation is: <span class="math display">\[
H_1: ρ ≠ 0
\]</span> rho is not zero, which means that the relationship in the population is not equal to 0; (“there is an association in the population”)</p>
<p><strong>One-tailed significance test:</strong></p>
<p>The <strong>null hypothesis</strong> for a one-tailed significance test of a correlation is: <span class="math display">\[
H_0: ρ = 0
\]</span> which means that the relationship in the population is equal to 0; (“there is no association”)</p>
<p>The <strong>alternative hypothesis</strong> for a one-tailed significance test of a correlation where ρ &gt; 0 is: <span class="math display">\[
H_1: ρ &gt; 0
\]</span> which means that there is a positive relationship in the population.</p>
<pre><code>OR</code></pre>
<p>The <strong>alternative hypothesis</strong> for a one-tailed significance test of a correlation where ρ &lt; 0 is: <span class="math display">\[
H_1: ρ &lt; 0
\]</span> which means that there is a negative relationship in the population.</p>
<pre><code>These hypotheses are in terms of ρ.</code></pre>
</section><section id="assumptions-of-a-correlation-matrix" class="level3" data-number="16.5.2"><h3 data-number="16.5.2" class="anchored" data-anchor-id="assumptions-of-a-correlation-matrix">
<span class="header-section-number">16.5.2</span> Assumptions of a Correlation Matrix:</h3>
<p><strong>1.</strong> The two variables should be measured at the interval or ratio level (e.i., <strong><em>continuous</em></strong>).</p>
<pre><code>a.  If interested in the relationship between two categorical variables or ranks (categorical is misleading) you can use "Spearman" as the type of correlation. But if you have two binary variables (i.e. living/dead, black/white, success/failure), then use a Phi Correlation coefficient.

b.  If interested in a mix, one can use various functions like "mixedCor" in the `psych` package.

c.  If interested in how the levels of a variable like male or female affect the correlation of two variables, we conduct a partial correlation which allow us to control for a third or more other variables using the function "pcor.test" in the `ppcor` package.</code></pre>
<p><strong>2.</strong> There should exist a <strong>linear relationship</strong> between the two variables.</p>
<p><strong>3.</strong> Variables should be roughly <strong>normally distributed</strong>.</p>
<p><strong>4.</strong> Each observation in the dataset should have a <strong>pair of values</strong>.</p>
<p><strong>5.</strong> There should be <strong>no extreme outliers</strong> in the dataset.</p>
</section><section id="checking-assumptions" class="level3" data-number="16.5.3"><h3 data-number="16.5.3" class="anchored" data-anchor-id="checking-assumptions">
<span class="header-section-number">16.5.3</span> Checking Assumptions</h3>
<section id="level-of-measurement" class="level5" data-number="16.5.3.0.1"><h5 data-number="16.5.3.0.1" class="anchored" data-anchor-id="level-of-measurement">
<span class="header-section-number">16.5.3.0.1</span> Level of Measurement</h5>
<p>Using the <code>skimr</code> package, we will get data set information such as the distribution (histogram) of, and the type/level of measurement for the variables in the “mtcars” data set.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mtcars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.09</td>
<td style="text-align: right;">6.03</td>
<td style="text-align: right;">10.40</td>
<td style="text-align: right;">15.43</td>
<td style="text-align: right;">19.20</td>
<td style="text-align: right;">22.80</td>
<td style="text-align: right;">33.90</td>
<td style="text-align: left;">▃▇▅▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">cyl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.19</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">▆▁▃▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">230.72</td>
<td style="text-align: right;">123.94</td>
<td style="text-align: right;">71.10</td>
<td style="text-align: right;">120.83</td>
<td style="text-align: right;">196.30</td>
<td style="text-align: right;">326.00</td>
<td style="text-align: right;">472.00</td>
<td style="text-align: left;">▇▃▃▃▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">146.69</td>
<td style="text-align: right;">68.56</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: right;">96.50</td>
<td style="text-align: right;">123.00</td>
<td style="text-align: right;">180.00</td>
<td style="text-align: right;">335.00</td>
<td style="text-align: left;">▇▇▆▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.70</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">4.93</td>
<td style="text-align: left;">▇▃▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.22</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.51</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">3.61</td>
<td style="text-align: right;">5.42</td>
<td style="text-align: left;">▃▃▇▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17.85</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">14.50</td>
<td style="text-align: right;">16.89</td>
<td style="text-align: right;">17.71</td>
<td style="text-align: right;">18.90</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: left;">▃▇▇▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">vs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">am</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">gear</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▆▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">carb</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">▇▂▅▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <code>skimr</code> function nicely displays the data. It indicates that all the variables are currently in numeric format but based on the descriptive information and on the information provided by <code><a href="https://rdrr.io/r/datasets/mtcars.html">?mtcars</a></code>, only 6 variables meet the level of measurement assumption (interval, ratio), we will then create a data frame from mtcars named cars_df where we leave these 6 variables as continuous double/numeric and categorize the other 5 variables. We present the summary using the <code>gtsummary</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cars_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="op">{</span></span>
<span>   <span class="va">vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">vs</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"S"</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">am</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"automatic"</span>, <span class="st">"manual"</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="va">cyl</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span></span>
<span>   <span class="va">gear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">gear</span><span class="op">)</span></span>
<span>   <span class="va">carb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">ordered</a></span><span class="op">(</span><span class="va">carb</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cars_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">gtsummary</span><span class="fu">::</span><span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">tbl_summary</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="va">mpg</span> <span class="op">~</span> <span class="st">"Miles/(US) gallon"</span>,</span>
<span>      <span class="va">cyl</span> <span class="op">~</span> <span class="st">"Number of cylinders"</span>,</span>
<span>      <span class="va">disp</span> <span class="op">~</span> <span class="st">"Displacement (cu.in.)"</span>,</span>
<span>      <span class="va">hp</span> <span class="op">~</span>  <span class="st">"Gross horsepower"</span>,</span>
<span>      <span class="va">drat</span> <span class="op">~</span> <span class="st">"Rear axle ratio"</span>,</span>
<span>      <span class="va">wt</span> <span class="op">~</span>  <span class="st">"Weight (1000 lbs)"</span>,</span>
<span>      <span class="va">qsec</span> <span class="op">~</span> <span class="st">"1/4 mile time"</span>,</span>
<span>      <span class="va">vs</span> <span class="op">~</span>  <span class="st">"Engine (0 = V-shaped, 1 = straight)"</span>,</span>
<span>      <span class="va">am</span> <span class="op">~</span> <span class="st">"Transmission (0 = automatic, 1 = manual)"</span>,</span>
<span>      <span class="va">gear</span> <span class="op">~</span> <span class="st">"Number of forward gears"</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="st">"continuous2"</span>,</span>
<span>    statistic <span class="op">=</span> <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"{median} ({p25}, {p75})"</span>,</span>
<span>      <span class="st">"{min}, {max}"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/add_n.html">add_n</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/bold_italicize_labels_levels.html">bold_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/modify.html">modify_header</a></span><span class="op">(</span><span class="va">label</span> <span class="op">~</span> <span class="st">"**Variable**"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="sdkclctcrp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sdkclctcrp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sdkclctcrp thead, #sdkclctcrp tbody, #sdkclctcrp tfoot, #sdkclctcrp tr, #sdkclctcrp td, #sdkclctcrp th {
  border-style: none;
}

#sdkclctcrp p {
  margin: 0;
  padding: 0;
}

#sdkclctcrp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sdkclctcrp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sdkclctcrp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sdkclctcrp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sdkclctcrp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sdkclctcrp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdkclctcrp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sdkclctcrp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sdkclctcrp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sdkclctcrp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sdkclctcrp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sdkclctcrp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sdkclctcrp .gt_spanner_row {
  border-bottom-style: hidden;
}

#sdkclctcrp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sdkclctcrp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sdkclctcrp .gt_from_md > :first-child {
  margin-top: 0;
}

#sdkclctcrp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sdkclctcrp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sdkclctcrp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sdkclctcrp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sdkclctcrp .gt_row_group_first td {
  border-top-width: 2px;
}

#sdkclctcrp .gt_row_group_first th {
  border-top-width: 2px;
}

#sdkclctcrp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdkclctcrp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sdkclctcrp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sdkclctcrp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdkclctcrp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdkclctcrp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sdkclctcrp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sdkclctcrp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sdkclctcrp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdkclctcrp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sdkclctcrp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdkclctcrp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sdkclctcrp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdkclctcrp .gt_left {
  text-align: left;
}

#sdkclctcrp .gt_center {
  text-align: center;
}

#sdkclctcrp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sdkclctcrp .gt_font_normal {
  font-weight: normal;
}

#sdkclctcrp .gt_font_bold {
  font-weight: bold;
}

#sdkclctcrp .gt_font_italic {
  font-style: italic;
}

#sdkclctcrp .gt_super {
  font-size: 65%;
}

#sdkclctcrp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sdkclctcrp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sdkclctcrp .gt_indent_1 {
  text-indent: 5px;
}

#sdkclctcrp .gt_indent_2 {
  text-indent: 10px;
}

#sdkclctcrp .gt_indent_3 {
  text-indent: 15px;
}

#sdkclctcrp .gt_indent_4 {
  text-indent: 20px;
}

#sdkclctcrp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<strong>Variable</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variable</strong></th>
<th id="<strong>N</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N</strong></th>
<th id="<strong>N = 32</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>N = 32</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Miles/(US) gallon</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">19.2 (15.4, 22.8)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Range</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">10.4, 33.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Number of cylinders</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">11 (34%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;6</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">7 (22%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">14 (44%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Displacement (cu.in.)</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">196 (121, 326)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Range</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">71, 472</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Gross horsepower</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">123 (97, 180)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Range</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">52, 335</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Rear axle ratio</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">3.70 (3.08, 3.92)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Range</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">2.76, 4.93</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Weight (1000 lbs)</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">3.33 (2.58, 3.61)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Range</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">1.51, 5.42</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">1/4 mile time</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Median (IQR)</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">17.71 (16.89, 18.90)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Range</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">14.50, 22.90</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Engine (0 = V-shaped, 1 = straight)</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;V</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">18 (56%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;S</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">14 (44%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Transmission (0 = automatic, 1 = manual)</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;automatic</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">19 (59%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;manual</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">13 (41%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Number of forward gears</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">15 (47%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">12 (38%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">5 (16%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">carb</td>
<td class="gt_row gt_center" headers="n">32</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">7 (22%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">10 (31%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">3 (9.4%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">10 (31%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;6</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">1 (3.1%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8</td>
<td class="gt_row gt_center" headers="n"><br></td>
<td class="gt_row gt_center" headers="stat_0">1 (3.1%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="even">
<td colspan="3" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<p>Now we will examine only the 6 variables meeting the measurement assumption.</p>
</section><section id="linear-relationship" class="level4" data-number="16.5.3.1"><h4 data-number="16.5.3.1" class="anchored" data-anchor-id="linear-relationship">
<span class="header-section-number">16.5.3.1</span> Linear Relationship</h4>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">mpg</span> <span class="op">+</span> <span class="va">disp</span> <span class="op">+</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">drat</span> <span class="op">+</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">qsec</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cars_df</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Simple Scatterplot Matrix"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Basic Scatterplot Matrix-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on this simple scatterplot matrix, all variables seem to follow a linear relationship, therefore, we will examine the normality and outliers assumption of these variables.</p>
</section><section id="normality-distribution-and-extreme-outliers" class="level4" data-number="16.5.3.2"><h4 data-number="16.5.3.2" class="anchored" data-anchor-id="normality-distribution-and-extreme-outliers">
<span class="header-section-number">16.5.3.2</span> Normality distribution and extreme outliers</h4>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"MPG Q-Q plot"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Miles per Gallon"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">disp</span>, </span>
<span>         main <span class="op">=</span> <span class="st">"Disp Q-Q plot"</span>,</span>
<span>         ylab <span class="op">=</span> <span class="st">"Displacement"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">disp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">hp</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"hp Q-Q plot"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Gross horsepower"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">hp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">drat</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"drat Q-Q plot"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Rear axle ratio"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">drat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">wt</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"wt Q-Q plot"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Weight"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">wt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">qsec</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"qsec Q-Q plot"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"1/4 Mile Time"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">qsec</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Normality and outlier tests-qqplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A combination of ggqqplot and plot_annotation can also be used for the qq plot chart creation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MPG_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>                 main <span class="op">=</span> <span class="st">"MPG boxplot"</span>,</span>
<span>                 ylab <span class="op">=</span> <span class="st">"Miles per Gallon"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DISP_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">disp</span>,</span>
<span>                  main <span class="op">=</span> <span class="st">"Disp boxplot"</span>,</span>
<span>                  ylab <span class="op">=</span> <span class="st">"Displacement"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">HP_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">hp</span>,</span>
<span>                main <span class="op">=</span> <span class="st">"hp boxplot"</span>,</span>
<span>                ylab <span class="op">=</span> <span class="st">"Gross HP"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DRAT_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">drat</span>,</span>
<span>                  main <span class="op">=</span> <span class="st">"drat boxplot"</span>,</span>
<span>                  ylab <span class="op">=</span> <span class="st">"drat"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WT_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">wt</span>,</span>
<span>                main <span class="op">=</span> <span class="st">"wt boxplot"</span>,</span>
<span>                ylab <span class="op">=</span> <span class="st">"Weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qsec_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">qsec</span>,</span>
<span>       main <span class="op">=</span> <span class="st">"qsec boxplot"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"1/4 Mile Time"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Normality tests boxplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MPG_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>              main <span class="op">=</span> <span class="st">"MPG Histogram"</span>,</span>
<span>              xlab <span class="op">=</span> <span class="st">"Miles per Gallon"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DISP_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">disp</span>,</span>
<span>               main <span class="op">=</span> <span class="st">"disp Histogram"</span>, </span>
<span>               xlab <span class="op">=</span> <span class="st">"Displacement"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">HP_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">hp</span>,</span>
<span>             main <span class="op">=</span> <span class="st">"hp Histogram"</span>,</span>
<span>             xlab <span class="op">=</span> <span class="st">"Gross HP"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DRAT_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">drat</span>,</span>
<span>               main <span class="op">=</span> <span class="st">"drat Histogram"</span>,</span>
<span>               xlab <span class="op">=</span> <span class="st">"drat"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WT_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">wt</span>,</span>
<span>             main <span class="op">=</span> <span class="st">"wt Histogram"</span>,</span>
<span>             xlab <span class="op">=</span> <span class="st">"Weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">QSEC_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">qsec</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"qsec Histogram"</span>,</span>
<span>          ylab <span class="op">=</span> <span class="st">"1/4 Mile Time"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Normality tests histograms-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important procedures
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>We will run the correlation matrix using a “Pearson Correlation” for these data without resolving or reviewing some of the issues found with non-normality and extreme outliers for procedural and visual methods used to develop correlation matrices. However,
<ul>
<li>
<p><strong><em>Normality of variables:</em></strong> The qqplots, boxplots, and histograms visually hightlight that most of the variables have non-normality issues, for some of the variables, the issues with non-normality might not be too extreme for use in a pearson correlation. However, for three of the variables (displacement (disp), horse power (hp), and weight (wt)), the violation of non-normality might require one of the following strategies because non normally distributed data inflate the significance of “r” and outliers can have great influence on Pearson’ corrrelations as it might result in misleading results (like no association or very low association):</p>
<ul>
<li>
<em>Strategies to assist non normal distributions:</em> Data transformations (such as log), Spearman rho correlation, Kendall tau’s correlation.</li>
</ul>
</li>
<li>
<p><strong><em>Presence of outliers</em></strong> The qqplots, and boxplots visually hightlight that most of the outliers present should be further analyzed as these can have great influence on Pearson’ corrrelations because they might provide misleading results/associations (like no association or very low association):</p>
<ul>
<li>
<em>Strategies for outliers:</em> Removal (if it is a confirmed measurement failure or a collection error), The use of Spearman correlation, adjustment/revisions.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</section></section><section id="computation-of-a-correlation-matrix" class="level3" data-number="16.5.4"><h3 data-number="16.5.4" class="anchored" data-anchor-id="computation-of-a-correlation-matrix">
<span class="header-section-number">16.5.4</span> Computation of a Correlation Matrix</h3>
<p>The function in R to create a basic correlation matrix is <strong>cor()</strong>. This function uses “pearson” as the default coefficient/method. The other two methods (for ranked correlation matrices) are “kendall” or “spearman”.</p>
<p>If the data set has missing values, one can ask (use =) for “everything”, “all.obs”, “complete.obs”, “na.or.complete”, or “pairwise.complete.obs”. The easiest and most commonly used approach is “use = complete.obs” in which missing values are handled by case wise deletion (and if there are no complete cases, that gives an error).</p>
<p>Our data set (mtcars2) is composed of only the 6 “continuous” variables of the data set ’mtcars”, and does not have missing values, therefore we can use the default method of “pearson” and do not need to specify a use for missing values.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cars_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">mtcars2</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">cars_cor</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Basic correlation matrix"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Basic correlation matrix</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.85</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;">0.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">-0.85</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">-0.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">-0.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">-0.43</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can also display the lower triangle of the pearson coefficient matrix by using the upper.tri() function.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">upper</span><span class="op">&lt;-</span><span class="va">cars_cor</span></span>
<span><span class="va">upper</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span><span class="op">(</span><span class="va">cars_cor</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">""</span></span>
<span><span class="va">upper</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">upper</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">upper</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Lower triangle of matrix correlation"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Lower triangle of matrix correlation</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">mpg</th>
<th style="text-align: left;">disp</th>
<th style="text-align: left;">hp</th>
<th style="text-align: left;">drat</th>
<th style="text-align: left;">wt</th>
<th style="text-align: left;">qsec</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: left;">-0.85</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: left;">-0.78</td>
<td style="text-align: left;">0.79</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: left;">0.68</td>
<td style="text-align: left;">-0.71</td>
<td style="text-align: left;">-0.45</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: left;">-0.87</td>
<td style="text-align: left;">0.89</td>
<td style="text-align: left;">0.66</td>
<td style="text-align: left;">-0.71</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">0.42</td>
<td style="text-align: left;">-0.43</td>
<td style="text-align: left;">-0.71</td>
<td style="text-align: left;">0.09</td>
<td style="text-align: left;">-0.17</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Another way (easier) to compute and visualize the lower triangle of a correlation matrix could be accomplished by using the function datasummary_correlation() in the <code>modelsummary</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://modelsummary.com/man/datasummary_correlation.html">datasummary_correlation</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tinytable_5wo7v3887nl0kb0p0vrf</title>
<style>
.table td.tinytable_css_mx5w6jzxj1mg8cwz13jm, .table th.tinytable_css_mx5w6jzxj1mg8cwz13jm {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_wd0bflztjwmc9yvcmoy3, .table th.tinytable_css_wd0bflztjwmc9yvcmoy3 {    text-align: left; }
.table td.tinytable_css_k3454v73hxt88hsqwpwh, .table th.tinytable_css_k3454v73hxt88hsqwpwh {    text-align: right; }
.table td.tinytable_css_pghw2fxiccqq3zkqi7jc, .table th.tinytable_css_pghw2fxiccqq3zkqi7jc {    text-align: right; }
.table td.tinytable_css_ailmzrt0fand0xpl44ac, .table th.tinytable_css_ailmzrt0fand0xpl44ac {    text-align: right; }
.table td.tinytable_css_smgguisg3i3z6vosn7ry, .table th.tinytable_css_smgguisg3i3z6vosn7ry {    text-align: right; }
.table td.tinytable_css_fzha30s8p3g36kvbnntj, .table th.tinytable_css_fzha30s8p3g36kvbnntj {    text-align: right; }
.table td.tinytable_css_j3bruu3mlkn2l9m9di9c, .table th.tinytable_css_j3bruu3mlkn2l9m9di9c {    text-align: right; }
    </style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><div class="container">
      <table class="table table-borderless" id="tinytable_5wo7v3887nl0kb0p0vrf" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col"> </th>
                <th scope="col">mpg</th>
                <th scope="col">disp</th>
                <th scope="col">hp</th>
                <th scope="col">drat</th>
                <th scope="col">wt</th>
                <th scope="col">qsec</th>
              </tr></thead>
<tbody>
<tr>
<td>mpg </td>
                  <td>1   </td>
                  <td>.   </td>
                  <td>.   </td>
                  <td>.   </td>
                  <td>.   </td>
                  <td>.</td>
                </tr>
<tr>
<td>disp</td>
                  <td>-.85</td>
                  <td>1   </td>
                  <td>.   </td>
                  <td>.   </td>
                  <td>.   </td>
                  <td>.</td>
                </tr>
<tr>
<td>hp  </td>
                  <td>-.78</td>
                  <td>.79 </td>
                  <td>1   </td>
                  <td>.   </td>
                  <td>.   </td>
                  <td>.</td>
                </tr>
<tr>
<td>drat</td>
                  <td>.68 </td>
                  <td>-.71</td>
                  <td>-.45</td>
                  <td>1   </td>
                  <td>.   </td>
                  <td>.</td>
                </tr>
<tr>
<td>wt  </td>
                  <td>-.87</td>
                  <td>.89 </td>
                  <td>.66 </td>
                  <td>-.71</td>
                  <td>1   </td>
                  <td>.</td>
                </tr>
<tr>
<td>qsec</td>
                  <td>.42 </td>
                  <td>-.43</td>
                  <td>-.71</td>
                  <td>.09 </td>
                  <td>-.17</td>
                  <td>1</td>
                </tr>
</tbody>
</table>
</div>

    <script>
      function styleCell_tinytable_t68iq65z2lh1pgcxyh8j(i, j, css_id) {
        var table = document.getElementById("tinytable_5wo7v3887nl0kb0p0vrf");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_5wo7v3887nl0kb0p0vrf');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_t68iq65z2lh1pgcxyh8j(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_5wo7v3887nl0kb0p0vrf");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 0, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 1, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 2, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 3, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 4, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 5, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 6, 'tinytable_css_mx5w6jzxj1mg8cwz13jm') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 0, 'tinytable_css_wd0bflztjwmc9yvcmoy3') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 1, 'tinytable_css_k3454v73hxt88hsqwpwh') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 2, 'tinytable_css_pghw2fxiccqq3zkqi7jc') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 3, 'tinytable_css_ailmzrt0fand0xpl44ac') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 4, 'tinytable_css_smgguisg3i3z6vosn7ry') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 5, 'tinytable_css_fzha30s8p3g36kvbnntj') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(0, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(1, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(2, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(3, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(4, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(5, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
window.addEventListener('load', function () { styleCell_tinytable_t68iq65z2lh1pgcxyh8j(6, 6, 'tinytable_css_j3bruu3mlkn2l9m9di9c') })
    </script>
</div>
</div>
<p>However, this table is difficult to interpret as p-values for the pearson correlation coefficients are not included. The package <code>Hmisc</code> has functions available to provide p-values and to format the results of a correlation matrix. The function <strong>rcorr()</strong> provides the p-values of a correlation matrix. It is necessary to convert the data frame to a matrix to run this procedure:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cars_cor_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/rcorr.html">rcorr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cars_cor_p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mpg  disp    hp  drat    wt  qsec
mpg   1.00 -0.85 -0.78  0.68 -0.87  0.42
disp -0.85  1.00  0.79 -0.71  0.89 -0.43
hp   -0.78  0.79  1.00 -0.45  0.66 -0.71
drat  0.68 -0.71 -0.45  1.00 -0.71  0.09
wt   -0.87  0.89  0.66 -0.71  1.00 -0.17
qsec  0.42 -0.43 -0.71  0.09 -0.17  1.00

n= 32 


P
     mpg    disp   hp     drat   wt     qsec  
mpg         0.0000 0.0000 0.0000 0.0000 0.0171
disp 0.0000        0.0000 0.0000 0.0000 0.0131
hp   0.0000 0.0000        0.0100 0.0000 0.0000
drat 0.0000 0.0000 0.0100        0.0000 0.6196
wt   0.0000 0.0000 0.0000 0.0000        0.3389
qsec 0.0171 0.0131 0.0000 0.6196 0.3389       </code></pre>
</div>
</div>
<p>Another way in which a correlation matrix could be constructed displaying p-values is with the function corr.test in the <code>psych</code> package. The default alpha = 0.05 and the default method is “pearson”. Both could be changed to for instance, alpha = 0.01 and method = “spearman”. However, the R documentation for this function indicates that non parametric method calculation is slow.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars2_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/psych/man/corr.test.html">corr.test</a></span><span class="op">(</span><span class="va">mtcars2</span><span class="op">)</span><span class="op">$</span><span class="va">p</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">mtcars2_p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000020</td>
<td style="text-align: right;">0.0001243</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0525761</td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000009</td>
<td style="text-align: right;">0.0000478</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0525761</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">0.0000002</td>
<td style="text-align: right;">0.0000001</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0499439</td>
<td style="text-align: right;">0.0002487</td>
<td style="text-align: right;">0.0000478</td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0.0000178</td>
<td style="text-align: right;">0.0000053</td>
<td style="text-align: right;">0.0099888</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000478</td>
<td style="text-align: right;">0.6777366</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000415</td>
<td style="text-align: right;">0.0000048</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.6777366</td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0.0170820</td>
<td style="text-align: right;">0.0131440</td>
<td style="text-align: right;">0.0000058</td>
<td style="text-align: right;">0.6195826</td>
<td style="text-align: right;">0.3388683</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can use the package `rstatix to: 1. Create a pearson coefficient correlation matrix with the function cor_mat() 2. Create a matrix of p-values (95% significance is default) with the function cor_pmat(), but p-values are not adjusted or rounded so it is not the best display 3. Create a visual representation of the matrix</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Correlation matrix between all variables</span></span>
<span><span class="va">mtcars2_corr</span> <span class="op">&lt;-</span> <span class="va">mtcars2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_mat</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mtcars2_corr</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  rowname   mpg  disp    hp   drat    wt   qsec
* &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 mpg      1    -0.85 -0.78  0.68  -0.87  0.42 
2 disp    -0.85  1     0.79 -0.71   0.89 -0.43 
3 hp      -0.78  0.79  1    -0.45   0.66 -0.71 
4 drat     0.68 -0.71 -0.45  1     -0.71  0.091
5 wt      -0.87  0.89  0.66 -0.71   1    -0.17 
6 qsec     0.42 -0.43 -0.71  0.091 -0.17  1    </code></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars2_corr_p</span> <span class="op">&lt;-</span> <span class="va">mtcars2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_pmat</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mtcars2_corr_p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  rowname      mpg     disp           hp       drat        wt       qsec
  &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 mpg     0        9.38e-10 0.000000179  0.0000178  1.29e- 10 0.0171    
2 disp    9.38e-10 0        0.0000000714 0.00000528 1.22e- 11 0.0131    
3 hp      1.79e- 7 7.14e- 8 0            0.00999    4.15e-  5 0.00000577
4 drat    1.78e- 5 5.28e- 6 0.00999      0          4.78e-  6 0.62      
5 wt      1.29e-10 1.22e-11 0.0000415    0.00000478 2.27e-236 0.339     
6 qsec    1.71e- 2 1.31e- 2 0.00000577   0.62       3.39e-  1 0         </code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mtcars2_corr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">#cor_get_pval() %&gt;%</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_reorder.html">cor_reorder</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">pull_lower_triangle</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_plot.html">cor_plot</a></span><span class="op">(</span>label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Correlation using rstatix-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <strong>rquery.cormat</strong> in the <code>corrplot</code> package also provides the results of a correlation matrix showing r, p-values, and a visual representation. It can also provide formated results.</p>
<!-- ```{r} -->
<!-- #| label: Correlation visuals using rquery.cormat -->
<!-- #| code-fold: false -->
<!-- #| echo: true -->
<!-- # have to apply the source -->
<!-- #source("http://www.sthda.com/upload/rquery_cormat.r") -->
<!-- rquery.cormat(mtcars2, type="flatten", graph=TRUE) -->
<!-- ``` -->
<p>The package <code>corrplot</code> allows us to visually format the correlation matrix so that it can be a full matrix or the bottom or top triangle. Additionally, it can display the correlation coefficients, or another with p-values, or a visual representation of significant values.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">testmtcars2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/cor.mtest.html">cor.mtest</a></span><span class="op">(</span><span class="va">mtcars2</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cars_cor</span>,</span>
<span>         type <span class="op">=</span> <span class="st">'full'</span>,</span>
<span>         method <span class="op">=</span> <span class="st">'circle'</span>,</span>
<span>         addCoef.col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>         <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Correlation with corrplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cars_cor</span>,</span>
<span>         type <span class="op">=</span> <span class="st">'lower'</span>,</span>
<span>         p.mat <span class="op">=</span> <span class="va">testmtcars2</span><span class="op">$</span><span class="va">p</span>,</span>
<span>         number.font <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         tl.cex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         pch.cex <span class="op">=</span> <span class="fl">2</span>,</span>
<span>         insig <span class="op">=</span> <span class="st">'p-value'</span>, </span>
<span>         sig.level <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>         <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">cars_cor</span>,</span>
<span>         type <span class="op">=</span> <span class="st">'upper'</span>,</span>
<span>         tl.pos <span class="op">=</span> <span class="st">'n'</span>,</span>
<span>         p.mat <span class="op">=</span> <span class="va">testmtcars2</span><span class="op">$</span><span class="va">p</span>,</span>
<span>         method <span class="op">=</span> <span class="st">'color'</span>,</span>
<span>         diag <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>         sig.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span><span class="op">)</span>,          </span>
<span>         pch.cex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>         insig <span class="op">=</span> <span class="st">'label_sig'</span>,</span>
<span>         pch.col <span class="op">=</span> <span class="st">'grey20'</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Correlation with corrplot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using the add = TRUE call inside the upper triangle <strong>corrplot</strong> function, one could stack matrices, but this method is complicated and requires adjusting sizes and labeling. To create stack full matrices it is best to use the function <strong>corrplot.mixed</strong> also in the <code>corrplot</code> package. Sadly, some of the features of <strong>corrplot</strong> are not available, but you can still have very informative visual outputs.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.mixed.html">corrplot.mixed</a></span><span class="op">(</span><span class="va">cars_cor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The following matrix visualization using the function <strong>chart.Correlation</strong> in the package <code>PerformanceAnalytics</code> provides many of the assumption tests for a correlation. The top triangle is the (absolute) value of the correlation coefficient (the default method is “pearson” but it could be changed to “kendall” or “spearman”) plus the result of the cor.test as stars (this can be changed to other symbols). In the bottom triangle of the matrix are the bivariate scatterplots, with a fitted line. This is a quick way to visualize a correlation matrix coefficient and significant relationships while examining assumptions. A must to run this function is to use the data set developed with the six continuous variables of interest (mtcars2).</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/chart.Correlation.html">chart.Correlation</a></span><span class="op">(</span><span class="va">mtcars2</span>,</span>
<span>                  histogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter
Warning in par(usr): argument 1 does not name a graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/Correlation visuals using chart.Correlation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<pre><code>*  The same visualization could be built using the **pairs()** function in base R, but **pairs()** is not very user friendly to construct a correlation matrix.
*  In addition, the function **pair.panel** in the `psych` package returns something similar. 
    *  Of interest about this function is that it also allows for regression visualization as regression lines and coinfidence intervals could be part of the output.</code></pre>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>A simple correlation matrix could be ran using the full data set and then select the variables significantly correlated and then see if any of them meet the assumptions.</li>
<li>The <strong>cpairs()</strong> in the <code>gclus</code> package allows for a plot matrix while ordering and coloring the subplots by correlation.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="other-correlation-types-spearman-and-partial" class="level2" data-number="16.6"><h2 data-number="16.6" class="anchored" data-anchor-id="other-correlation-types-spearman-and-partial">
<span class="header-section-number">16.6</span> Other Correlation Types (Spearman and Partial)</h2>
<section id="spearman-ranking-of-variables-non-parametric" class="level3" data-number="16.6.1"><h3 data-number="16.6.1" class="anchored" data-anchor-id="spearman-ranking-of-variables-non-parametric">
<span class="header-section-number">16.6.1</span> Spearman (ranking of variables, non-parametric)</h3>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span><span class="va">cars_partial</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">cars_spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">carb</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(mtcars$cyl, mtcars$carb, method = "spearman"):
Cannot compute exact p-value with ties</code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># This is simply an example of how a spearman procedure is done. Although we can </span></span>
<span><span class="co"># use continuous variables, the exact p-value cannot be computed with ties. </span></span>
<span><span class="co"># Therefore, it is better to use ranked data in order to compute the exact p-value. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="partial-correlation" class="level3" data-number="16.6.2"><h3 data-number="16.6.2" class="anchored" data-anchor-id="partial-correlation">
<span class="header-section-number">16.6.2</span> Partial Correlation</h3>
<p>The Partial correlation is the correlation of two variables while controlling for a third or more other variables. The partial correlation coefficient is a measure of the strength of the linear relationship between two variables after entirely controlling for the effects of other variables.</p>
<p>To conduct the <strong>partial correlation test</strong></p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># partial correlation between "mpg" and "wt"  given "am"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ppcor/man/pcor.test.html">pcor.test</a></span><span class="op">(</span><span class="va">cars_partial</span><span class="op">$</span><span class="va">mpg</span>,<span class="va">cars_partial</span><span class="op">$</span><span class="va">wt</span>,<span class="va">cars_partial</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    estimate      p.value statistic  n gp  Method
1 -0.7835341 1.867415e-07 -6.790807 32  1 pearson</code></pre>
</div>
</div>
<p>This is the calculation of the correlation between miles per gallon and weight while controlling the variable “am” = Transmission (0 = automatic, 1 = manual).</p>
</section></section><section id="example-of-r-in-examining-the-relationship-in-a-pair-of-variables-using-the-pearson-correlation-coefficient-type-of-correlation" class="level2" data-number="16.7"><h2 data-number="16.7" class="anchored" data-anchor-id="example-of-r-in-examining-the-relationship-in-a-pair-of-variables-using-the-pearson-correlation-coefficient-type-of-correlation">
<span class="header-section-number">16.7</span> Example of <em>r</em> in examining the relationship in a pair of variables using the Pearson Correlation Coefficient type of correlation</h2>
<p>Using the <strong>ggscatter</strong> function in the <code>ggpubr</code> package, we could examine the Pearson coefficient and the related p-value for a pair of variables we found of interest in the scatterplot matrix above. We will explore the relationship between the the number of miles per gallon and the weight of a vehicle.</p>
<section id="hypothesis-test-between-mpg-and-wt" class="level3" data-number="16.7.1"><h3 data-number="16.7.1" class="anchored" data-anchor-id="hypothesis-test-between-mpg-and-wt">
<span class="header-section-number">16.7.1</span> Hypothesis test between mpg and wt</h3>
<p>We will test if a vehicle’s weight is related to its fuel efficiency.</p>
<p><span class="math display">\[
H_0: ρ = 0,
\]</span> <span class="math display">\[
H_1: ρ ≠ 0
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter</a></span><span class="op">(</span><span class="va">cars_df</span>, x <span class="op">=</span> <span class="st">"mpg"</span>, y <span class="op">=</span> <span class="st">"wt"</span>, </span>
<span>          add <span class="op">=</span> <span class="st">"reg.line"</span>,</span>
<span>          conf.int <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          cor.coef <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>          cor.method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>          xlab <span class="op">=</span> <span class="st">"Miles/(US) gallon"</span>,</span>
<span>          ylab <span class="op">=</span> <span class="st">"Weight (1000 lbs)"</span></span>
<span>          <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="04_correlation_files/figure-html/mpg and weight using ggscatter in ggpubr-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can then conduct a Pearson correlation test using the <strong>cor.test</strong> function.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cars_ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">$</span><span class="va">wt</span>, <span class="va">cars_df</span><span class="op">$</span><span class="va">mpg</span>, </span>
<span>                    method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="va">cars_ct</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  cars_df$wt and cars_df$mpg
t = -9.559, df = 30, p-value = 1.294e-10
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.9338264 -0.7440872
sample estimates:
       cor 
-0.8676594 </code></pre>
</div>
</div>
<p><strong>To test the Hypothesis:</strong></p>
<p>The test statistic t is rounded to -10 and the corresponding p-value is 1e-10.</p>
<p>Since the p-value is less than .05, we have sufficient evidence to say that the correlation between a vehicle’s weight and miles per gallon is statistically significant.</p>
<p><strong>We can also test the hypothesis manually:</strong></p>
<p>Using a t-test:</p>
<p>n(ordered pairs) = 32 r(sample correlation coefficient) = -0.868 alpha = 0.05</p>
<p><span class="math display">\[
t = \frac {r}{\sqrt{\frac {1-r^2}{n-2}}}
\]</span></p>
<p><span class="math display">\[
t = \frac {-0.868}{\sqrt{\frac {0.2466}{30}}} = -9.574
\]</span></p>
<p>The critical values <span class="math inline">\(-t_O = - 2.0423\)</span> and <span class="math inline">\(t_o = 2.0423\)</span> form the rejection regions for the standardized test statistic. Since t = -9.574 and it is less than <span class="math inline">\(-t_O = - 2.0423\)</span>, we reject the null hypothesis and we can conclude that there is enough evidence at the 95% level of significance that there is a significant linear correlation between fuel efficiency and a vehicle’s weight.</p>
<p>Alternatively, we can use a table of critical values for pearson’s r. In this two-tailed example, with df = 30 and alpha = .05 the critical value is .349, then we can make a decision, |<em>r</em>| = 0.868 is greater than 0.349, which means that we reject the null hypothesis and conclude that there is a relationship between vehicle weight and miles per gallon, r(30) = -0.868, p&lt;0.05</p>
<p>Furthermore,</p>
<blockquote class="blockquote">
<ul>
<li>The direction of the relationship is negative (i.e., heavier vehicles have lower numbers of miles per gallon or are less fuel efficient), meaning that when one variable increases the other variable decreases.</li>
<li>The magnitude, or strength, of the association is approximately strong (5 &lt; | <em>r</em> |).</li>
</ul>
</blockquote>
</section></section><section id="references" class="level2" data-number="16.8"><h2 data-number="16.8" class="anchored" data-anchor-id="references">
<span class="header-section-number">16.8</span> References</h2>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/gabrielodom\.github\.io\/PHC6099_rBiostat\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../lessons_original/04_anova_random_intercept.html" class="pagination-link" aria-label="Random Intercept Model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Random Intercept Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lessons_original/04_regression_ols.html" class="pagination-link" aria-label="Ordinary Least Squares Regression">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Ordinary Least Squares Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gabrielodom/PHC6099_rBiostat/edit/main/lessons_original/04_correlation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gabrielodom/PHC6099_rBiostat/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>